I"…<p><strong>æŠ¥é”™è®°å½•ï¼šMATLAB Deep Learning Toolboxï¼ŒæŠ¥é”™: Invalid input data. Invalid number of spatial dimensions. Layer expects 0 but received 1.</strong></p>

<p>åœ¨ä½¿ç”¨MATLAB Deep Learning Toolboxåœ¨æ„å»ºç¥ç»ç½‘ç»œæ—¶ï¼Œæƒ³è¦ä½¿ç”¨featureInputLayerå‡½æ•°æ„å»ºç¥ç»ç½‘ç»œçš„ç‰¹å¾è¾“å…¥å±‚ï¼Œç”¨äºæ¥æ”¶æ•°å€¼ç‰¹å¾ï¼Œä½†æ˜¯åœ¨è¿›è¡Œcustom training loopè¿‡ç¨‹ä¸­ä½¿ç”¨forwardå‡½æ•°æ—¶æŠ¥é”™ã€‚</p>

<p>ç²¾ç®€åçš„æµ‹è¯•ä»£ç ï¼š</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">clc</span><span class="p">,</span> <span class="nb">clear</span>

<span class="c1">% define network</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">featureInputLayer</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s1">'Name'</span><span class="p">,</span> <span class="s1">'inputLayer'</span><span class="p">);</span>
<span class="c1">% convert layer graph to dlnetwork object</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">dlnetwork</span><span class="p">(</span><span class="n">net</span><span class="p">);</span>

<span class="c1">% specify formatted batch input</span>
<span class="nb">input</span> <span class="o">=</span> <span class="nb">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span><span class="c1">% 4, the number of the features; 16, batch size;</span>
<span class="nb">input</span> <span class="o">=</span> <span class="n">dlarray</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="s1">'SB'</span><span class="p">);</span>

<span class="c1">% forward</span>
<span class="nb">result</span> <span class="o">=</span> <span class="n">forward</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="nb">input</span><span class="p">);</span>
</code></pre></div></div>
<p>å®Œæ•´æŠ¥é”™ä¿¡æ¯ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Error using dlnetwork/validateForwardInputs
Layer 'inputLayer': Invalid input data. Invalid number of spatial dimensions. Layer expects 0 but received 1.

Error in dlnetwork/forward (line 555)
            [x, doForwardExampleInputs] = validateForwardInputs(net, x, "forward");

Error in test2 (line 13)
result = forward(net, input);
</code></pre></div></div>
<p>æŠ¥é”™åŸå› ï¼š</p>

<p>dlarrayå‡½æ•°ä½¿ç”¨é”™è¯¯ã€‚æ ¹æ®MATLABçš„<a href="https://ww2.mathworks.cn/help/deeplearning/ref/dlarray.html?searchHighlight=dlarray&amp;s_tid=srchtitle_dlarray_1">dlarrayå‡½æ•°å®˜æ–¹æ–‡æ¡£</a>ï¼Œå½“ç¥ç»ç½‘ç»œçš„è¾“å…¥ä¸ºç‰¹å¾æ—¶ï¼Œæ•°å€¼è¦è½¬æ¢ä¸ºâ€CBâ€æ ¼å¼çš„dlarrayï¼Œè€Œä¸æ˜¯â€SBâ€æ ¼å¼(æˆ‘æƒ³å½“ç„¶è®¤ä¸ºæ˜¯â€œSpatial-Batchâ€æ ¼å¼)ã€‚</p>

<p><img src="https://blogimages-1309804558.cos.ap-nanjing.myqcloud.com/img/image-20220710122651510.png" alt="image-20220710122651510" /></p>

<p>å› æ­¤ï¼Œåªéœ€è¦å°†åŸä»£ç çš„ç¬¬10è¡Œæ”¹å†™å¦‚ä¸‹ä»£ç å³å¯ã€‚</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">input</span> <span class="o">=</span> <span class="n">dlarray</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="s1">'CB'</span><span class="p">);</span>
</code></pre></div></div>
:ET