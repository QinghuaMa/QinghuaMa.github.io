I"Ê<head>
<script>
  MathJax = {
    tex: {
      tags: 'all',  // should be 'ams', 'none', or 'all'
      inlineMath: [['$','$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']]
    }
  };
  </script>
<script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
</head>

<h1>Content</h1>

<ul id="markdown-toc">
  <li><a href="#å¸¦æ­£åˆ™åŒ–é¡¹çš„æœ€å°äºŒä¹˜æ³•" id="markdown-toc-å¸¦æ­£åˆ™åŒ–é¡¹çš„æœ€å°äºŒä¹˜æ³•">å¸¦æ­£åˆ™åŒ–é¡¹çš„æœ€å°äºŒä¹˜æ³•</a></li>
  <li><a href="#æœ€å¤§åéªŒä¼°è®¡ä¸-regularized-lse-çš„å…³ç³»" id="markdown-toc-æœ€å¤§åéªŒä¼°è®¡ä¸-regularized-lse-çš„å…³ç³»">æœ€å¤§åéªŒä¼°è®¡ä¸ Regularized LSE çš„å…³ç³»</a></li>
</ul>

<h2 id="å¸¦æ­£åˆ™åŒ–é¡¹çš„æœ€å°äºŒä¹˜æ³•">å¸¦æ­£åˆ™åŒ–é¡¹çš„æœ€å°äºŒä¹˜æ³•</h2>

<p>åœ¨ä»‹ç»æœ€å°äºŒä¹˜æ³•çš„æ–‡ç« ä¸­æåˆ°ï¼Œå¯¹äºå…·æœ‰ $N$ ä¸ªæ ·æœ¬ç‚¹çš„æœ€å°äºŒä¹˜æ‹Ÿåˆé—®é¢˜ï¼Œæœ€å°äºŒä¹˜æŸå¤±å‡½æ•°çš„å½¢å¼ä¸ºï¼š</p>

\[L(w)=\sum_{i=1}^N|w^Tx_i-y_i|^2\label{1-1}\]

<p>å¹¶å…·æœ‰è§£æè§£ï¼Œ</p>

\[\hat{w}=(X^TX)^{-1}X^TY\label{1-2}\]

<p>å…¶ä¸­ï¼Œæ•°æ®ç‚¹ $D={(x_1,y_1), (x_2, y_2), \cdots, (x_N, y_N)}$ï¼Œä¸” $x_i\in\mathbb{R}^p$ï¼Œ$y_i\in\mathbb{R}$ï¼Œ$i=1,2,\cdots, N$ï¼Œæ‹Ÿåˆå‡½æ•°ä¸º $f(w)=w^Tx$ã€‚</p>

<p>ä½†åœ¨å®è·µä¸­ï¼Œå½“ï¼ˆ1ï¼‰æ ·æœ¬ç‚¹çš„æ•°é‡ $N$ æ²¡æœ‰é‚£ä¹ˆå¤§ï¼Œæˆ–è€…ï¼ˆ2ï¼‰$N$ å°äº $x$ çš„ç»´åº¦ $p$ æ—¶ï¼Œå¼ $\eqref{1-2}$ å°±å¯èƒ½æ²¡æœ‰è§£æè§£ã€‚ä»æ•°å­¦çš„è§’åº¦çœ‹ï¼Œæ˜¯å› ä¸ºå¼ $\eqref{1-2}$ ä¸­çš„çŸ©é˜µ $X^TX$ ä¸å¯é€†ï¼›ä»æœºå™¨å­¦ä¹ å®è·µçš„è§’åº¦çœ‹ï¼Œè¿™ç§æƒ…å†µæ˜“é€ æˆè¿‡æ‹Ÿåˆç°è±¡ã€‚</p>

<p>ä¸ºäº†è§£å†³æœ€å°äºŒä¹˜æ³•çš„è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå¼•å…¥â€œæ­£åˆ™åŒ–â€çš„æ¡†æ¶ã€‚
åœ¨å¼ $\eqref{1-1}$ è¡¨ç¤ºçš„æŸå¤±å‡½æ•°ä¸­æ·»åŠ æƒ©ç½šé¡¹ï¼ˆPenaltyï¼‰ $\lambda P(w)$ï¼Œå¾—åˆ°<strong>å¸¦æ­£åˆ™åŒ–é¡¹çš„æœ€å°äºŒä¹˜æ³•ï¼ˆRegularized LSEï¼‰</strong>ï¼š</p>

\[\arg\max \limits_w \big[L(w)+ {\lambda P(w)}\big]\]

<p>æˆ‘ä»¬æœ€å¸¸ä½¿ç”¨çš„æ˜¯ $L_1$ æƒ©ç½šé¡¹å’Œ $L_2$ æƒ©ç½šé¡¹ï¼š</p>

\[\begin{align*}
&amp;L_1:P(w)=||w||_1\\
&amp;L_2:P(w)=||w||_2^2=w^Tw\\
\end{align*}\]

<blockquote>
  <p>$L_1$ æ­£åˆ™åŒ–çš„æ¨¡å‹ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºLassoå›å½’ï¼›</p>

  <p>$L_2$ æ­£åˆ™åŒ–çš„æ¨¡å‹ï¼Œåˆ™ç§°ä¹‹ä¸ºRidgeå›å½’ï¼ˆå²­å›å½’ï¼Œäº¦ç§°ä¸ºæƒå€¼è¡°å‡ï¼‰ã€‚</p>
</blockquote>

<p>åœ¨LSEçš„æŸå¤±å‡½æ•°ä¸­å¼•å…¥ $L_2$ æ­£åˆ™é¡¹åï¼š</p>

\[\begin{aligned}
J(w)&amp;=\sum_{i=1}^N||w^Tx_i-y_i||_2^2+\lambda w^Tw\\
&amp;=(w^TX^TXw-2w^TX^TY+Y^TY)+\lambda w^Tw\\
&amp;=w^T(X^TX+\lambda I)w-2w^TX^TY+Y^TY
\end{aligned}\]

<p>äºæ˜¯ä¼˜åŒ–æŸå¤±å‡½æ•°</p>

\[\begin{align}
\hat{w}&amp;=\arg\min\limits_{w} J(w)\notag \\
&amp;=\arg\min\limits_{w}\Big[\sum_{i=1}^N||w^Tx_i-y_i||^2_2+\lambda w^Tw\Big]\notag \\
&amp;=\arg\min\limits_{w}\Big[ w^T(X^TX+\lambda I)w-2w^TX^TY+Y^TY\Big] \label{1-3}
\end{align}\]

<p>å¯ä»¥å¾—åˆ°</p>

\[\begin{aligned}
&amp;\dfrac{\partial J(w)}{\partial w}=2(X^TX+\lambda I)-2X^TY=0\\
\Rightarrow&amp;\hat{w} = (X^TX+\lambda I)^{-1}X^TY
\end{aligned}\label{1-4}\]

<p>å¯¹äºå…¬å¼$\eqref{1-4}$ä¸­çš„çŸ©é˜µ $X^TX+\lambda I$ï¼š$X^TX$ æ˜¯åŠæ­£å®šçŸ©é˜µï¼Œ$\lambda I$ æ˜¯å¯¹è§’é˜µï¼Œå› æ­¤çŸ©é˜µ $X^TX+\lambda I$ ä¸€å®šæ˜¯æ­£å®šçš„ï¼Œæ‰€ä»¥ $X^TX+\lambda I$ä¸€å®šå¯é€†ã€‚</p>

<p>å› æ­¤ï¼Œ$L_2$ æ­£åˆ™åŒ–æ‰‹æ®µå°±è§£å†³äº†å¼ $\eqref{1-2}$ ä¸­çš„çŸ©é˜µ $X^TX$ ä¸å¯é€†çš„é—®é¢˜ï¼Œå¹¶ä¸”åœ¨å®è·µä¸­ï¼Œå¯ä»¥è¾¾åˆ°æŠ‘åˆ¶è¿‡æ‹Ÿåˆç°è±¡çš„æ•ˆæœã€‚</p>

<hr />

<h2 id="æœ€å¤§åéªŒä¼°è®¡ä¸-regularized-lse-çš„å…³ç³»">æœ€å¤§åéªŒä¼°è®¡ä¸ Regularized LSE çš„å…³ç³»</h2>

<p>æœ€å°äºŒä¹˜æ³•çš„æ–‡ç« ä¸­è¿˜æåˆ°ï¼Œä»å‚æ•°ä¼°è®¡çš„è§’åº¦çœ‹ï¼Œ<strong>å½“å™ªå£°ä¸ºæœä»é›¶å‡å€¼çš„æ­£æ€åˆ†å¸ƒæ—¶ï¼Œæå¤§ä¼¼ç„¶ä¼°è®¡æ³•ç­‰ä»·äºæœ€å°äºŒä¹˜æ³•</strong>ã€‚</p>

<blockquote>
  <p>è´å¶æ–¯æ´¾å¯¹äºå‚æ•°ä¼°è®¡çš„è§‚ç‚¹$^{[1]}$</p>

  <p>å¯¹äºæå¤§ä¼¼ç„¶ä¼°è®¡è€Œè¨€ï¼ŒæœªçŸ¥å‚æ•°ï¼ˆå¾…ä¼°è®¡å‚æ•°ï¼‰ $\theta$ å°±æ˜¯ä¸€ä¸ªç®€å•çš„æœªçŸ¥æ•°ï¼Œåœ¨æŠ½æ ·ä¹‹å‰ï¼Œæˆ‘ä»¬å¯¹ $\theta$ æ²¡æœ‰ä»»ä½•äº†è§£ï¼Œæ‰€æœ‰çš„ä¿¡æ¯éƒ½æ¥è‡ªäºæ ·æœ¬ã€‚è€Œè´å¶æ–¯æ´¾åˆ™ä¸ç„¶ï¼Œä»–ä»¬çš„å‡ºå‘ç‚¹æ˜¯ï¼š<strong>åœ¨è¿›è¡ŒæŠ½æ ·ä¹‹å‰ï¼Œæˆ‘ä»¬å·²ç»å¯¹ $\theta$ æœ‰äº†ä¸€å®šçš„çŸ¥è¯†ï¼Œå«åšå…ˆéªŒçŸ¥è¯†</strong>ã€‚å¹¶ä¸”ï¼Œè´å¶æ–¯å­¦æ´¾è¿›ä¸€æ­¥è¦æ±‚ï¼šè¿™ç§å…ˆéªŒçŸ¥è¯†å¿…é¡»ç”¨ $\theta$ çš„æŸç§æ¦‚ç‡åˆ†å¸ƒè¡¨è¾¾å‡ºæ¥ã€‚</p>
</blockquote>

<p>ä»ç„¶å‡è®¾æœ‰æ‹Ÿåˆæ›²çº¿ $y=f(w)+\varepsilon=w^Tx+\varepsilon$ï¼Œå¹¶ä¸”å™ªå£°æœä»åˆ†å¸ƒ $\varepsilon\sim N(0, \sigma^2)$ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šï¼Œæ ¹æ®è´å¶æ–¯å­¦æ´¾çš„è§‚ç‚¹å‡è®¾æˆ‘ä»¬å¯¹äºå¾…ä¼°å‚æ•° $w$ æœ‰ä¸€ä¸ªå…ˆéªŒä¼°è®¡ï¼š$w\sim N(0,\sigma_0^2)$ï¼Œåˆ™åœ¨å·²çŸ¥ $y$ çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥å¾—åˆ°åéªŒä¼°è®¡ $p(w\vert y)$ï¼š</p>

\[p(w|y)=\dfrac{p(y|w)p(w)}{p(y)}\]

<p>æ ¹æ®<strong>æœ€å¤§åéªŒä¼°è®¡ï¼ˆMaximum a posteriori estimation, MAPï¼‰</strong>çš„æ–¹æ³•ï¼Œæœ‰</p>

\[\begin{align*}
\hat{w}_{\mathrm{MAP}}&amp;=\arg\max\limits_{w}\log \prod_{i=1}^Np(w|y_i)\\
&amp;=\arg\max\limits_{w}\log \prod_{i=1}^N p(y_i|w)p(w)\\
&amp;=\arg\max\limits_{w}\log \prod_{i=1}^N\Big[\dfrac1{\sqrt{2\pi}\sigma}\exp\{-\dfrac{(y_i-w^Tx_i)^2}{2\sigma^2}\}\dfrac1{\sqrt{2\pi}\sigma_0}\exp\{-\dfrac{w^2}{2\sigma_0^2}\}\Big]\\
&amp;=\arg\min\limits_{w}\sum_{i=1}^N \Bigl[(y_i-w^Tx_i)^2+\dfrac{\sigma^2}{\sigma_0^2}||w||_2^2\Bigr]\\
(\mathrm{Let}:\lambda=\sigma^2/\sigma_0^2)&amp;=\arg\min\limits_{w}\sum_{i=1}^N\Big[(y_i-w^Tx_i)^2+\lambda||w||_2^2\Big]\\
\end{align*}\]

<p>å³</p>

\[\hat{w}_{\mathrm{MAP}}=\arg\min\limits_{w}\sum_{i=1}^N\Big[(y_i-w^Tx_i)^2+\lambda||w||_2^2\Big]\label{1-5}\]

<p>å¼ $\eqref{1-5}$ ä¸å¸¦æœ‰ $L_2$ æ­£åˆ™é¡¹æœ€å°äºŒä¹˜æ³•çš„å½¢å¼ $\eqref{1-3}$ æ˜¯ä¸€è‡´çš„ã€‚</p>

<hr />

<p><strong>æ€»ç»“</strong></p>

<ol>
  <li>å½“ï¼ˆ1ï¼‰å™ªå£°ä¸ºæœä»é›¶å‡å€¼çš„æ­£æ€åˆ†å¸ƒæ—¶ $\varepsilon\sim N(0, \sigma^2)$ï¼Œæå¤§ä¼¼ç„¶ä¼°è®¡æ³•ç­‰ä»·äºæœ€å°äºŒä¹˜æ³•ï¼›</li>
  <li>å½“ï¼ˆ2ï¼‰å™ªå£°ä¸ºæœä»é›¶å‡å€¼çš„æ­£æ€åˆ†å¸ƒæ—¶ $\varepsilon\sim N(0, \sigma^2)$ï¼Œä¸”ï¼ˆ2ï¼‰å¾…ä¼°å‚æ•° $w$ çš„å…ˆéªŒä¼°è®¡ä¹Ÿæœä»é›¶å‡å€¼çš„æ­£æ€åˆ†å¸ƒæ—¶$w\sim N(0,\sigma_0^2)$ï¼Œæœ€å¤§åéªŒä¼°è®¡ç­‰ä»·äºå¸¦ $L_2$ æ­£åˆ™åŒ–é¡¹çš„æœ€å°äºŒä¹˜æ³•ï¼›</li>
</ol>

<hr />

<p><strong>å‚è€ƒ</strong></p>

<p>[1] é™ˆå¸Œå­º. æ¦‚ç‡è®ºä¸æ•°ç†ç»Ÿè®¡. åˆè‚¥: ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦å‡ºç‰ˆç¤¾, 2009.2(2019.8é‡å°).</p>

<p>[2] shuhuai008. <a href="https://www.bilibili.com/video/BV1aE411o7qd?p=12&amp;vd_source=f209f402a13cd84c99ed077bf0b9afb9">ã€æœºå™¨å­¦ä¹ ã€‘ã€ç™½æ¿æ¨å¯¼ç³»åˆ—ã€‘P12</a></p>

:ET